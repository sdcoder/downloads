<section class="row ruled" ng-controller="VINController" id="CollateralInformation" ng-init="setupVINCollection('@Model.CollateralInformation.ToJSON()')" >
    <div>
	    <div class="medium-9 columns">
	        <h2 class="brand">@Model.GetPartNumber()Collateral Information</h2>

            <div class="stepcomplete" ng-cloak ng-show="VehicleInfo.Received">
                <div class="status-icon"><img src="/Content/images/icon-success.png" alt="icon-success" width="20px"></div>                
                <p class="statusnote">
                    Vehicle information has been received, thank you.<br />
                    <br />
                    VIN (Vehicle Identification Number): {{VehicleInfo.VIN}}<br />
                    Property Description (Make & Model): {{VehicleInfo.MakeAndModel}} <br />
                    Year: {{VehicleInfo.Year}}<br />

                    <br />
                    <a href="" ng-click="VehicleInfo.Received=false;" ng-show="!VehicleInfo.AutoSatisfied">Click here to edit your VIN or vehicle information</a>
                </p>
            </div>
        </div>
    </div>

    <div>
	    <div class="medium-6 columns">
            <fieldset ng-disabled="VehicleInfo.Loading" ng-show="!VehicleInfo.Received" ng-cloak>
	            <p><strong class="brand">Due by @Model.DueDate.ToString("D")</strong></p>
	            <p>Please provide us with the vehicle information requested below.</p>
		        <form name="VINEntryForm" novalidate ls-validate-on-submit>
		            <label>Vehicle Identification Number (VIN)</label>
		            <input type="text" name="VIN" value="" ng-model="VehicleInfo.VIN" ls-restrict-to-pattern="/^[A-Za-z0-9]+$/" maxlength="17" ls-proper-case="upper" ls-track-visited required ls-blur="validateVIN()">
		
		            <label>Mileage</label>
		            <input type="text" value="" ng-model="VehicleInfo.Mileage" name="Mileage" ls-currency-only filter-name="number" maxlength="7" min="1" max="1000000" ls-track-visited required>
	                <div ng-show="VINEntryForm.Mileage.$hasVisited && !VINEntryForm.Mileage.$error.required &&  VINEntryForm.Mileage.$error.max" ng-cloak="">
	                    <div class="formalert hide-no-js">
	                        <p>Please enter a value less than 1,000,000.</p>
                        </div>
	                </div>
		
		            <label>@Model.CollateralInformation.TransactionDescription</label>
		            <input type="text" value="" name="TransactionAmount" ng-model="VehicleInfo.TransactionAmount" ls-currency-only min="1" max="@Model.CollateralInformation.RequestedLoanAmount" ls-track-visited required>
	                <div ng-show="VINEntryForm.TransactionAmount.$hasVisited && !VINEntryForm.TransactionAmount.$error.required && VINEntryForm.TransactionAmount.$error.max" ng-cloak="">
	                    <div class="formalert hide-no-js">
	                        <p>Please enter a value less than @Model.CollateralInformation.RequestedLoanAmount.ToString("C")</p>
                        </div>
	                </div>

                    <input type="button" class="button button-small" value="Continue" ng-disabled="!VINEntryForm.$valid || VehicleInfo.Loading"  ng-show="!VehicleInfo.Vehicles" ng-click="searchForVehicles()" />

                    <div ng-cloak ng-show="VehicleInfo.Vehicles && !VehicleInfo.NoneOfAboveSelected">
		            <p>Please confirm that your vehicle is the one listed below.</p>
                        <div ng-repeat="vehicle in VehicleInfo.Vehicles">
                            <input type="radio" name="VinVehicle" id="VinVehicle{{$index}}" ng-click="saveVehicleInfo(vehicle)"><label for="VinVehicle{{$index}}">{{vehicle.Year}} {{vehicle.Make}} {{vehicle.Model}} {{vehicle.Description}}</label><br>
                        </div>
		                <input type="radio" name="VinVehicle" value="None of these" id="VinEntryNoneOfTheAbove" ng-click="VehicleInfo.NoneOfAboveSelected = true"><label for="VinEntryNoneOfTheAbove">None of these</label>
                    </div>
                    <div ng-cloak ng-if="VehicleInfo.NoneOfAboveSelected">
		                <label>Year</label>
		                <input type="text" name="Year" value="" ng-model="VehicleInfo.Year" ls-numbers-only maxlength="4" minlength="4" min="1900" max="@(DateTime.Now.Year + 1)" ls-track-visited required>
		                <label>Make</label>
		                <input type="text" name="Make" value="" ng-model="VehicleInfo.Make" maxlength="30"  ls-proper-case ls-track-visited required>
		                <label>Model</label>
		                <input type="text" name="Model" value="" ng-model="VehicleInfo.Model" maxlength="30"  ls-proper-case  ls-track-visited required>

                        <input type="button" class="button button-small" value="Save" ng-disabled="!VINEntryForm.$valid || VehicleInfo.Loading" ng-click="saveUserEnteredVehicle()" />
                    </div>

                    <img src="@Model.CdnBaseUrl/ajax-loader.gif" id="LoadingImage" alt="" ng-cloak ng-show="VehicleInfo.Loading"/>

		        </form>
	        </fieldset>
            <div id="VINConfirmModal" class="reveal small"  data-reveal>
                <button class="close-button" data-close aria-label="Close modal" type="button"><span aria-hidden="true" class="close-reveal-modal no-print">&times;</span></button>
                <h1>Please Confirm Your Vehicle Identification Number</h1>
                <p>The Vehicle Information Number entered does not appear to be valid. Please note the VINs for vehicles manufactured after 1981 are 17 characters and do not contain the letters I, O, and Q. Please double-check your entry before moving forward.”</p>
                <h3 class="brand"><strong>{{VehicleInfo.VIN}}</strong></h3>
                <a href="" class="button button-medium first" ng-click="confirmCurrentVIN();">Yes, this is correct</a>
                <a href="" class="button button-medium" ng-click="closeVINConfirmation();">No, I need to correct the VIN</a>
            </div>

	    </div>
	    <div class="medium-6 columns"></div>
    </div>
</section>
