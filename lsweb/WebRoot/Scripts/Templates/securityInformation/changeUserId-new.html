<div class="row">
    <div class="medium-12 columns full-mobile">
        <h2>Change User ID > <span class="subTitle">Create New User ID</span></h2>
    </div>
</div>

<section ng-if="Model.Applications && Model.CanUpdate" ng-cloak>
    <div class="row" ng-show="Model.alert" ng-cloak>
        <div class="medium-11 small-centered columns alert-box" ng-class="Model.alert.type">
            <span>{{Model.alert.message}}</span>
            <a class="close" ng-click="closeAlertMessage()">×</a>
        </div>
    </div>

    <div id="create-user-container" ng-show="Model.CanUpdate">
        <div class="row" ng-show="Model.Applications.length > 1">
            <div class="medium-12 columns full-mobile">
                <p>Your current user ID contains the accounts listed below. Please select those that you wish to create a new user ID for by checking the Yes, Create New User ID box.</p>
            </div>
        </div>

        <form name="createUserForm" novalidate>
            <div class="row" ng-show="Model.Applications.length > 1">
                <table class="small-6 small-offset-1 columns end account-table">
                    <thead>
                        <tr>
                            <th class="account-cell">Loan Amount</th>
                            <th class="account-cell">Funding Date</th>
                            <th class="account-cell">Yes, Create New user ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="app in Model.Applications">
                            <td class="account-cell">{{app.LoanAmount}}</td>
                            <td class="account-cell">{{app.FundingDate}}</td>
                            <td class="account-cell">
                                <input type="checkbox" value="{{app.ApplicationId}}"
                                       ng-checked="Model.SecurityInformation.SelectedApplications.indexOf(app.ApplicationId) > -1"
                                       ng-click="toggleApplicationSelected(app.ApplicationId)" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="row">
                <div class="medium-4 columns">
                    <label>Current Password</label>
                    <input type="password"
                           autocomplete="off"
                           id="CurrentPassword"
                           name="CurrentPassword"                         
                           ng-model="Model.SecurityInformation.Password"
                           ls-track-visited
                           required="required" maxlength="20" minlength="8">
                </div>
            </div>

            <div class="row">
                <div class="medium-4 columns">
                    <label>Enter New User ID</label>
                    <input type="text" id="NewUserName" name="NewUserName"
                           ng-model="Model.SecurityInformation.UserName"
                           required="required"
                           maxlength="20"
                           ng-minlength="6"
                           ng-pattern="/^[A-Za-z0-9!&$,-._@]+$/"
                           ls-restrict-to-pattern
                           ls-track-visited
                           ng-focus="Model.UserIdGainedFocus = true" />
                </div>
                <div class="medium-8 columns" ng-show="Model.UserIdGainedFocus" ng-cloak="">
                    <div class="forminfo aside">
                        <p ng-bind-html="getUserIdHint()"></p>
                    </div>
                </div>
            </div>

            <div class="row preference-actions">
                <div class="medium-6 columns">
                    <input type="submit"
                           id="CreateUserSubmit"
                           class="button"
                           value="Save"
                           ng-disabled="createUserForm.$invalid || !isApplicationSelected || waiting"
                           ng-click="saveCreateUser(createUserForm, Model.UserId, Model.SecurityInformation)" />
                    <button type="button" class="button" ng-click="cancel(createUserForm)">Cancel</button>
                    <img src="/content/images/ajax-loader.gif" ng-cloak ng-show="waiting" />
                </div>
            </div>
        </form>
    </div>
</section>

<section ng-if="Model.Applications && !Model.CanUpdate" ng-cloak>
    <div class="row">
        <div class="medium-12 columns full-mobile">
            <p>Because you have a loan application in process, you cannot create a new user ID until your outstanding application has been completed. We apologize for the inconvenience.</p>
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <button type="button" class="button" ng-click="cancel()">Cancel</button>
        </div>
    </div>
</section>

<section ng-if="!Model.Applications" ng-cloak>
    <div class="row">
        <div class="medium-12 columns">
            <p>Unable to get Security Information data from server.</p>
        </div>
    </div>
</section>